# Profitable-Sports-Betting-Model-Results
This repo shows the results/profitability of a sports betting model I made in R and Python that consistenly achieves 10% ROI. In this repo I show the end results of using a machine learning algorithm (namely a random forest) to generate game win probabilities and exploit those probabilities to place long-term profitable moneyline wagers (known as positive EV betting). I also demonstrate validity and trustworthiness of the algorithm through A) hypothesis testing of the random forest outputs as well as B) repeated backtesting on real sportsbooks odds to confirm that the model is indeed profitable. Please note that this repo shows ONLY THE RESULTS of the model NOT THE FEATURE ENGINEERING PROCESS. All of the analysis and backtesting was performed on a randomly selected 20% subset (test data) of the entire dataset with the remaining 80% (training data) being used to train the model. All feature engineering processes generated lagged variables for inputs to prevent data leakage (meaning all inputs used in the model will be available when it is time to make real predictions.  

## Explanation of Files in this Repo:

### Model_training.py
This is a python code chunk showing the splitting of the dataset into train and test sets. 20%  of the data was used for a test set where all validation/backtesting was done while the remaining 80% was used to train the random forest. Hyperparameters of the random forest are not disclosed. 


### Model_output_Regression_Curve.png
The random forest model produces probabilities that provide us a measure of the model's confidence/certainty in its predictions. If the probability is greater than .5 it predicts the team will win while if the probability is less than .5 it predicts the team will lose. Probabilities closer to 1 or 0 reflect a higher level of confidence in a team winning or losing respectively. In order to confirm that the model's outputed probabilities truly reflect the emperical frequency of teams winning or losing I conducted a logistic regression of the model's predictions for the test set against the true outcome for every game in the test dataset. After running a logistic regression I plotted the model's probabilities on the x-axis and partition the teams that won from those that lost on the y-axis (ie y distributed around 1 (top) means the team won that game, while y distributed around 0 (bottom) means the team lost). We see that the model's predicted probabilities (black line) straddle the line y=x (blue line). This confirms that the model is well-calibrated and produces probabilities that truly reflect a team's liklihood of winning. We also notice that the model is very conservative in its predictions as the model rarely produces a probability greater than .82 or less than .09. I confirm during backtesting against real data that this is non-problematic to generating profitable picks. 


### Model_Prediction_logistic_Regression.png
This is the output from running a logistic regression of the model's predicted probabilistic outputs against the true binary outcomes of the test data set. We first see that the model obtains a 63% raw accuracy which is statistically significant since our test set is indeed balanced at approx 50% win/lose teams. I focus on the p-value of the coefficient for the model's predictions which is .000 (approx 0) allowig me to reject the hypothesis that my model has no statistical significance in predicting game winners and accept the alternative (ie I can trust that the model has predictive power).  

### Betting_Model_vs_Sportsbooks_plots.png
Again, looking strictly at the test dataset I plotted my model's output probabilities on the x-axis and pinnacle sportsbook's implied probabilities on the y-axis. We see that my model's output is highly correlated to pinnacle implying that my model is achieving competitive accuracy. Nonetheless running a logistic regression analysis of pinnacle's sportsbooks odds showed pinnacle's implied probabilities to obtain a lower log loss than my model, however luckily this does not impede the model from generating positive expected value picks (ie a positive ROI) after hundreds of picks at other sportsbooks as described in the next section.  

### Positive_ROI.png
Finally, I converted pinnacle's implied probabilities for each game, to the percentage of wager returned upon a win (ex +150 means 150% of bet is returned upon a win while -130 is 77% of wager returned). (Since a loss results in losing the entire wager its return would be -100%). 
